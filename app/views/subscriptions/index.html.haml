%h1.ui.huge.header
  %i.icon.rss
  購読中のチャネル

- if !current_user
  .ui.warning.small.message
    %i.icon.warning.circle
    チャネルの購読には
    = link_to 'ログイン', login_path
    が必要です。

  .ui.stackable.grid
    .ui.three.columns.row
      .ui.column
        .ui.placeholder.segment
          .ui.icon.header
            %i.grey.icon.rss
          = link_to 'チャネルを作成する', new_channel_path, class: 'ui primary small button'

- else
  - if current_user.pro?
    = link_to new_channel_path, class: 'ui red small basic button' do
      %i.icon.plus
      新規チャネルを作成する

  - if !current_user.subscriptionable?
    .ui.warning.small.message
      .content
        %i.icon.warning.circle
        購読チャネル数の上限に達しています。新しく購読したい場合は他の配信中チャネルの購読を解除してください。
        - if !current_user.pro?
          または
          = link_to '有料プランに登録', new_charge_path
          することで#{User::MAX_SUBSCRIPTIONS_COUNT}つまで同時に購読可能になります。

  .ui.secondary.pointing.menu
    .active.item 購読中のチャネル
    .item
      （上限：
      = current_user.subscriptions.count
      \/
      = current_user.max_subscriptions_count
      ）

  .ui.stackable.grid
    - if @subscriptions.blank?
      .ui.column チャネルがありません
    - else
      - @subscriptions.each do |subscription|
        .ui.five.wide.column
          = render partial: 'card', locals: { subscription: subscription }

  %br

  .ui.secondary.pointing.menu
    .active.item 未配信のチャネル

  .ui.stackable.grid
    - if @draft_channels.blank?
      .ui.column チャネルがありません
    - else
      - @draft_channels.each do |channel|
        .ui.five.wide.column
          .ui.fluid.card
            .content
              .header
                = link_to channel.title, channel_path(channel)
                = channel_status_icon(channel.status)
              .description
                = channel.description.try(:truncate, 50)
            .extra.content
              - if channel.books_count == 0
                .ui.warning.small.message
                  .content
                    まだ本が登録されていないようです。「
                    = link_to '作品検索', books_path
                    」から本を追加して配信開始しましょう！
              - else
                .ui.small.list
                  .item
                    %i.icon.book
                    #{channel.books_count}冊
            .extra.content
              - if channel.books_count > 0 && current_user.subscriptionable?
                = link_to '配信開始', subscriptions_path(channel_id: channel.id), method: :post, class: "ui small red button"
              - else
                %button.ui.small.red.disabled.button 配信開始
              = link_to '編集', edit_channel_path(channel), class: "ui primary small basic button", data: {turbolinks: false}
