= render partial: 'courses/course_header', locals: {course: @subscription.course, subscription: @subscription, path: 'subscription'}

.ui.basic.center.aligned.segment
  .ui.secondary.center.aligned.segment
    - next_delivery = @subscription.next_delivery
    .ui.label 次回配信
    .ui.large.header
      - if @subscription.active?
        = @subscription.next_deliver_at.strftime('%m月%d日 %H:%M')
      - else
        （なし）
      - if next_delivery && next_delivery.book
        .sub.header
          #{next_delivery.book.author}『#{next_delivery.book.title}』
          %br
          （#{next_delivery.index} / #{ @subscription.delivery_count(next_delivery.book_id) }）

  %div
    - if @subscription.active?
      = link_to skip_subscription_path(@subscription), method: 'post', class: 'ui blue basic icon small button', 'data-tooltip'=>'スキップ', 'data-inverted'=>'', data: {confirm: '現在の本をスキップして次の本を配信します。本当によろしいですか？'} do
        %i.icon.fast.forward
        スキップ
      = link_to subscription_path(id: @subscription.id, status: 2), method: 'put', class: 'ui red basic icon small button', 'data-tooltip'=>'一時停止', 'data-inverted'=>'' do
        %i.icon.pause
        一時停止
    - if @subscription.paused?
      = link_to subscription_path(id: @subscription.id, status: 1), method: :put, class: 'ui blue basic icon small button', 'data-tooltip'=>'再開', 'data-inverted'=>'' do
        %i.icon.play
        配信再開
    - if @subscription.finished?
      %p このコースの配信は完了しました。もう一度読みたい場合は、一度購読を解除してから再度購読してください。

    / TMP
    - if @subscription.active?
      %br
      %br
      %br
      %div
        = link_to 'いますぐ配信', deliver_subscription_path(@subscription), method: 'post', class: 'ui red button'
