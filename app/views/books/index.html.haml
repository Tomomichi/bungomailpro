- content_for :breadcrumb do
  作品検索

= render partial: 'form', locals: {keyword: @keyword}

%br

- if @results.present?
  %h3.ui.small.dividing.header
    %i.icon.mini.history
    検索結果
  .ui.middle.alligned.divided.relaxed.large.list
    - @results.each do |result|
      .item
        .right.floated.content
          .ui.compact.small.menu
            - if current_user && @channels
              .ui.simple.dropdown.item
                = link_to 'チャネルに追加', add_book_channel_path(current_user.default_channel.token, book_id: result['作品ID'], author_id: result['人物ID']), method: :post, remote: :true
                .dropdown.icon
                .menu
                  - @channels.each do |channel|
                    = link_to channel.title, add_book_channel_path(channel.token, book_id: result['作品ID'], author_id: result['人物ID']), method: 'post', class: 'item', remote: true
            - else
              = link_to 'チャネルに追加', login_path, class: 'ui small basic button'
        .content
          .header
            = result['作品名']
            %small= result['副題']
            = link_to aozora_card_url(book_id: result['作品ID'], author_id: result['人物ID']), target: '_blank' do
              %i.icon.mini.external
          .meta
            %small
              = result['姓']
              = result['名']
- else
  %h3.ui.small.dividing.header
    %i.icon.mini.star
    人気の文豪
  .ui.four.doubling.cards
    .ui.card
      .image
      .content
        .header 夏目漱石
        .meta
        .description
      .extra.content
        %button.ui.small.button 作品一覧
        -# = link_to '作品一覧', author_path(1), class: 'ui button'


:javascript
  document.addEventListener("turbolinks:load", () => {
    // Ajaxで本のデータを受け取ってリストに追加
    document.body.addEventListener('ajax:success', (event) => {
      alert("チャネルに追加しました！");
    })
    document.body.addEventListener('ajax:error', (event) => {
      alert("チャネルへの追加に失敗しました…");
    })
  })
